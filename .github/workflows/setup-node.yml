name: setup-node
description: "Setup Node.js ⚙️ - Cache dependencies ⚡ - Install dependencies 🔧"
on:
  branch_protection_rule:
    types: [created, edited, deleted]

on:
  # Manual run
  workflow_dispatch:
  pull_request:
    paths:
      - 'package-lock.json'

jobs:
  validate-package-lock-json:
    runs-on: ubuntu-latest
      steps:
        - name: Setup Node.js ⚙️
          uses: actions/setup-node@v4
          with:
            node-version: 20
    
        - name: Cache dependencies ⚡
          id: cache_dependencies
          uses: actions/cache@v3
          with:
            path: node_modules
            key: node-modules-${{ hashFiles('package-lock.json') }}
    
        - name: Install dependencies 🔧
          shell: bash
          if: steps.cache_dependencies.outputs.cache-hit != 'true'
          run: npm ci
